{#
## This file is part of Invenio.
## Copyright (C) 2013, 2014, 2015 CERN.
##
## Invenio is free software; you can redistribute it and/or
## modify it under the terms of the GNU General Public License as
## published by the Free Software Foundation; either version 2 of the
## License, or (at your option) any later version.
##
## Invenio is distributed in the hope that it will be useful, but
## WITHOUT ANY WARRANTY; without even the implied warranty of
## MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
## General Public License for more details.
##
## You should have received a copy of the GNU General Public License
## along with Invenio; if not, write to the Free Software Foundation, Inc.,
## 59 Temple Place, Suite 330, Boston, MA 02111-1307, USA.
#}

{%- from "groups/helpers.html" import searchbar with context -%}
{%- from "communities/helpers.html" import community_panel_start  with context -%}
{%- from "communities/helpers.html" import community_panel_end  with context -%}
{%- from "communities/helpers.html" import searchbar with context -%}
{%- from "communities/helpers.html" import paginate with context -%}

{% extends "page.html" %}

{% bundles "communities.js", "communities.css" %}

{% block body %}
{{ community_panel_start(
     active="people",
     title="People",
     icon='fa fa-user fa-fw',
     btn='Invite member', btn_icon='fa fa-fw fa-plus', btn_href=url_for('community_manage.people_invite', community_id=community.id),
   ) }}
<div class="panel-body">
  <div>List of community members from all teams.</div>
</div>
{{ searchbar() }}
<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th class="col-md-7">{{ _("Member") }}</th>
      <th class="col-md-1">{{ _("Teams") }}</th>
      <th class="col-md-4"></th>
    </tr>
  </thead>
  <tbody>
      {%- for member in members %}
      <tr>
        <td>
          <div class="col-md-6">{{ member.nickname }}</div>
          <div class="col-md-6"><span class="text-muted">{{ member.email }}</span></div>
        </td>
        <td class="text-center vcenter">{{ member.usergroups|length }}</td>
        <td class="text-center btn-toolbar vcenter">
          <a class="btn btn-xs btn-danger" data-toggle="modal" data-target="#remove-member-modal">
            <i class="fa fa-fw fa-chain-broken"></i>{{ _("Remove") }}
          </a>
        </td>
      </tr>
      {%- endfor %}
  </tbody>
</table>
{# paginate() #}
{{ community_panel_end() }}
<div id="remove-member-modal" class="modal fade">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">
          <span aria-hidden="true">&times;</span>
        </button>
        <h4 class="modal-title">Delete user</h4>
      </div>
      <div class="modal-body">
        <p>
          You are about to delete user <b><span id="user-to-remove"></span></b>
          from all teams in <b><span>ZENODO</span></b> Community.
        </p>
        <p>User belongs to <span id="user-teams-to-remove"></span> groups.</p>
        <small>If you want to delete user from the particular group go to teams view.</small>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default pull-left" data-dismiss="modal"><i class="fa fa-fw fa-times"></i>{{ _("Close") }}</button>
        <button type="button" class="btn btn-danger" data-remove><i class="fa fa-fw fa-trash-o"></i>{{ _("Delete") }}</button>
      </div>
    </div>
  </div>
</div>
{% endblock %}

{#
## This file is part of Invenio.
## Copyright (C) 2015 CERN.
##
## Invenio is free software; you can redistribute it and/or
## modify it under the terms of the GNU General Public License as
## published by the Free Software Foundation; either version 2 of the
## License, or (at your option) any later version.
##
## Invenio is distributed in the hope that it will be useful, but
## WITHOUT ANY WARRANTY; without even the implied warranty of
## MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
## General Public License for more details.
##
## You should have received a copy of the GNU General Public License
## along with Invenio; if not, write to the Free Software Foundation, Inc.,
## 59 Temple Place, Suite 330, Boston, MA 02111-1307, USA.
#}

{%- import "accounts/settings/helpers.html" as helpers with context %}
{%- from "communities/helpers.html" import rights_label with context %}
{%- from "communities/helpers.html" import paginate with context %}

{%- extends "accounts/settings/index.html" %}

{% bundles "communities.css" %}

{% block settings_body %}
  {{ helpers.panel_start(
      _("My Teams"),
      with_body=False,
      icon="fa fa-users fa-fw",
      btn=_("Create new team"), btn_icon='fa fa-fw fa-plus', btn_href=url_for('.new')
     ) }}
  <!-- right panel -->
  <!-- description -->
  <div class="panel-body">  <!-- TODO: Hard coded/Configurable view description -->
    Lorem ipsum dolor sit amet, consectetur adipisicing elit. Facere enim perferendis libero repellendus vero ex fugit dolorum necessitatibus inventore dolores. Illo voluptatibus officia sequi dolor. Quod, provident maiores quo quia.
  </div>
  <!-- description -->
  <!-- search bar -->
  <ul class="list-group">
    <div class="list-group-item">
      <form action="." method="get" class="input-group">
        <input name="p" class="form-control" type="text" value="{{ p }}">
        <span class="input-group-btn">
          <button class="btn btn-primary" type=submit>
            <i class="fa fa-fw fa-search"></i><span>&nbsp;{{ _("Search") }}</span>
          </button>
        </span>
      </form>
    </div>
  </ul>
  <!-- end search bar -->
  <!-- teams list -->
  <table class="table table-striped table-hover">
    <thead>
      <tr>
        <th class="col-md-7">{{ _("Name") }}</th>
        <th class="col-md-1">{{ _("Members") }}</th>
        <th class="col-md-4"></th>
      </tr>
    </thead>
    <tbody>
      {%- for team in teams.items %}
      {%- if team.communityteam %}
      <tr>
        <td>
          <div>
            {%- set ct = team.communityteam|first %}
            <small>{{ ct.community|upper }}</small>
            <b>{{ team.name }}</b>
            {{ rights_label(ct.team_rights) }}
          </div>
          <br>
          <small>{{ team.description|truncate(200, True)|safe }}</small>
        </td>
        <td class="text-center vcenter">{{ team.users|length }}</td>
        <td class="text-center btn-toolbar vcenter">
          <a class="btn btn-xs btn-danger pull-right" href="{{ team.id }}/leave">
            <i class="fa fa-chain-broken"></i>{{ _(" Leave") }}
          </a>
          <a class="btn btn-xs btn-default pull-right" href="">
            <i class="fa fa fa-wrench"></i>{{ _("Manage") }}
          </a>
          <a class="btn btn-xs btn-default pull-right" href="{{ team.id }}/members">
            <i class="fa fa-users"></i>{{ _("Members") }}
          </a>
        </td>
      </tr>
      {%- endif %}
      {%- endfor %}
    </tbody>
  </table>
  <!-- end teams list -->
  {{ paginate(teams) }}
  <!-- end right panel -->
  {{ helpers.panel_end(with_body=False) }}
{% endblock %}
